\hypertarget{_legged_robot_8h_source}{}\doxysection{Legged\+Robot.\+h}
\label{_legged_robot_8h_source}\index{src/libs/loco/include/loco/robot/LeggedRobot.h@{src/libs/loco/include/loco/robot/LeggedRobot.h}}
\mbox{\hyperlink{_legged_robot_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_generalized_coordinates_robot_representation_8h}{loco/robot/GeneralizedCoordinatesRobotRepresentation.h}}"{}}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_robot_8h}{loco/robot/Robot.h}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_robot_state_8h}{loco/robot/RobotState.h}}"{}}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacecrl_1_1loco}{crl::loco}}\ \{}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb}{RobotLimb}}\ \{}
\DoxyCodeLine{00014\ \ \ \ \ \textcolor{comment}{//\ index\ of\ limb}}
\DoxyCodeLine{00015\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_a4c72d85f3b467d9e85ef6e311da0f476}{limbIndex}}\ =\ -\/1;}
\DoxyCodeLine{00016\ \ \ \ \ \textcolor{comment}{//\ this\ is\ the\ name\ of\ the\ limb}}
\DoxyCodeLine{00017\ \ \ \ \ std::string\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_a4c231e72215aa918e1020070e109e8ff}{name}};}
\DoxyCodeLine{00018\ \ \ \ \ \textcolor{comment}{//\ and\ all\ limbs\ have\ an\ end\ effector}}
\DoxyCodeLine{00019\ \ \ \ \ std::shared\_ptr<RB>\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_ab294e4672c01041638875ed67c07774b}{eeRB}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{comment}{//\ and\ this\ is\ a\ list\ of\ all\ the\ limb's\ joints\ -\/\ for\ easy\ access...}}
\DoxyCodeLine{00021\ \ \ \ \ std::vector<std::shared\_ptr<RBJoint>>\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_a8de5a8836dba4282e047e1c827391b87}{jointList}};}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \ \ \ \ \textcolor{comment}{//\ this\ is\ the\ vector\ from\ the\ CoM\ of\ the\ trunk\ to\ the\ end\ effector;\ it}}
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{comment}{//\ corresponds\ to\ a\ default\ step\ offset.\ Expressed\ in\ the\ coordinate\ frame}}
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{comment}{//\ of\ the\ trunk...}}
\DoxyCodeLine{00026\ \ \ \ \ \mbox{\hyperlink{classcrl_1_1_v3_d}{V3D}}\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_a459be2b72363250cf140a36388cb4a44}{defaultEEOffset}};}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{comment}{//\ this\ is\ ptr\ to\ ee\ we\ use\ for\ locomotion\ related\ tasks}}
\DoxyCodeLine{00028\ \ \ \ \ \mbox{\hyperlink{classcrl_1_1loco_1_1_r_b_end_effector}{RBEndEffector}}\ *\mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_ac56cb905b4e8538d600a720b97aaa205}{ee}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00033\ \ \ \ \ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_a4feebff38050eb1ff4a4abed8ff81556}{RobotLimb}}(\textcolor{keyword}{const}\ std::string\ \&\mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_a4c231e72215aa918e1020070e109e8ff}{name}},\ \textcolor{keyword}{const}\ std::shared\_ptr<RB>\ \&\mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_ab294e4672c01041638875ed67c07774b}{eeRB}},\ \textcolor{keyword}{const}\ std::shared\_ptr<RB>\ \&limbRoot)\ \{}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ this-\/>name\ =\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_a4c231e72215aa918e1020070e109e8ff}{name}};}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ this-\/>eeRB\ =\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_ab294e4672c01041638875ed67c07774b}{eeRB}};}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ this-\/>ee\ =\ \&\mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_ab294e4672c01041638875ed67c07774b}{eeRB}}-\/>rbProps.endEffectorPoints[0];}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ std::shared\_ptr<RB>\ tmpRB\ =\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_ab294e4672c01041638875ed67c07774b}{eeRB}};}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (tmpRB\ !=\ limbRoot)\ \{}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_a8de5a8836dba4282e047e1c827391b87}{jointList}}.insert(\mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_a8de5a8836dba4282e047e1c827391b87}{jointList}}.begin(),\ tmpRB-\/>pJoint);}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \ \ tmpRB\ =\ tmpRB-\/>pJoint-\/>parent;}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcrl_1_1_p3_d}{P3D}}\ eePos\ =\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_ac56cb905b4e8538d600a720b97aaa205}{ee}}-\/>\mbox{\hyperlink{classcrl_1_1loco_1_1_r_b_end_effector_a304db87e865897939f2d4e8a6966f4c0}{endEffectorOffset}};}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_a459be2b72363250cf140a36388cb4a44}{defaultEEOffset}}\ =\ limbRoot-\/>getLocalCoordinates(\mbox{\hyperlink{classcrl_1_1_v3_d}{V3D}}(limbRoot-\/>getWorldCoordinates(\mbox{\hyperlink{classcrl_1_1_p3_d}{P3D}}()),\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_ab294e4672c01041638875ed67c07774b}{eeRB}}-\/>getWorldCoordinates(eePos)));}
\DoxyCodeLine{00046\ \ \ \ \ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00051\ \ \ \ \ std::shared\_ptr<RBJoint>\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_a5028014c8c7c2fffe916429c226a3cdd}{getJointToTrunk}}()\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_a8de5a8836dba4282e047e1c827391b87}{jointList}}[0];}
\DoxyCodeLine{00053\ \ \ \ \ \}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \mbox{\hyperlink{classcrl_1_1_p3_d}{P3D}}\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_ab0eec06a21f7595d4805c62305bd85a3}{getEEWorldPos}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_ab294e4672c01041638875ed67c07774b}{eeRB}}-\/>getWorldCoordinates(this-\/>ee-\/>\mbox{\hyperlink{classcrl_1_1loco_1_1_r_b_end_effector_a304db87e865897939f2d4e8a6966f4c0}{endEffectorOffset}});}
\DoxyCodeLine{00057\ \ \ \ \ \}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \mbox{\hyperlink{classcrl_1_1_v3_d}{V3D}}\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_acdff625f2906304e1afe66f584f83b7c}{getEEWorldVel}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_ab294e4672c01041638875ed67c07774b}{eeRB}}-\/>getVelocityForPoint\_local(this-\/>ee-\/>\mbox{\hyperlink{classcrl_1_1loco_1_1_r_b_end_effector_a304db87e865897939f2d4e8a6966f4c0}{endEffectorOffset}});}
\DoxyCodeLine{00061\ \ \ \ \ \}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structcrl_1_1loco_1_1_robot_limb_a3ef4364d0fdfc01bc8c2b0e5016aa2fc}{isContact}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>ee-\/>\mbox{\hyperlink{classcrl_1_1loco_1_1_r_b_end_effector_a9a18af2e04a5d2bab5e0a9726c2a288e}{inContact}};}
\DoxyCodeLine{00065\ \ \ \ \ \}}
\DoxyCodeLine{00066\ \};}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00071\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classcrl_1_1loco_1_1_legged_robot}{LeggedRobot}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classcrl_1_1loco_1_1_robot}{Robot}}\ \{}
\DoxyCodeLine{00072\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{comment}{//\ we\ will\ assume\ that\ the\ trunk\ is\ just\ one\ rigid\ body\ for\ now,\ and\ that\ it}}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{comment}{//\ is\ the\ root\ of\ the\ robot...}}
\DoxyCodeLine{00075\ \ \ \ \ std::shared\_ptr<RB>\ trunk\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00076\ \ \ \ \ std::vector<std::shared\_ptr<RobotLimb>>\ limbs;}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{comment}{//\ it's\ useful\ to\ store\ standing\ pose\ as\ a\ nominal\ state}}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{comment}{//\ if\ it\ is\ not\ specified\ then\ just\ set\ initial\ state\ of\ robot\ (but\ it\ might}}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{comment}{//\ be\ dangerous...)}}
\DoxyCodeLine{00081\ \ \ \ \ \mbox{\hyperlink{classcrl_1_1loco_1_1_robot_state}{RobotState}}\ standingState;}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classcrl_1_1loco_1_1_legged_robot}{LeggedRobot}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *filePath,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *statePath\ =\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \ \ \mbox{\hyperlink{classcrl_1_1loco_1_1_legged_robot_a5ceab169961b7f36b0007033f3a4feff}{\string~LeggedRobot}}()\ \textcolor{keyword}{override}\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ std::shared\_ptr<RB>\ \mbox{\hyperlink{classcrl_1_1loco_1_1_legged_robot_a3342e98e0b4ee37df759a834c6226342}{getTrunk}}();}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcrl_1_1loco_1_1_legged_robot_abb9697bc85e84ba121f2560f4017f8f7}{addLimb}}(\textcolor{keyword}{const}\ std::string\ \&name,\ \textcolor{keyword}{const}\ std::shared\_ptr<RB>\ \&eeRB);}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcrl_1_1loco_1_1_legged_robot_abb9697bc85e84ba121f2560f4017f8f7}{addLimb}}(\textcolor{keyword}{const}\ std::string\ \&name,\ \textcolor{keyword}{const}\ std::string\ \&eeRBName);}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classcrl_1_1loco_1_1_legged_robot_a7af955f08e305c517943922bd01b1fa1}{getLimbCount}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \ \ std::shared\_ptr<RobotLimb>\ \mbox{\hyperlink{classcrl_1_1loco_1_1_legged_robot_a6ee8d6141bc9a7e0aa1dbbb448f8b3fb}{getLimb}}(\mbox{\hyperlink{math_defs_8h_a91ad9478d81a7aaf2593e8d9c3d06a14}{uint}}\ i)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00101\ \ \ \ \ std::shared\_ptr<RobotLimb>\ \mbox{\hyperlink{classcrl_1_1loco_1_1_legged_robot_a5146a067a7ec8e732540bf6c2d1e8643}{getLimbByName}}(\textcolor{keyword}{const}\ std::string\ \&name)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00102\ \};}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \}\ \ \textcolor{comment}{//\ namespace\ crl::loco}}

\end{DoxyCode}
